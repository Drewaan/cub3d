# **************************************************************************** #
#                                   CONFIG                                     #
# **************************************************************************** #

NAME        = cub3D
CC          = cc
CFLAGS      = -Wall -Wextra -Werror -Iincludes -Ilibft/include -IMLX42/include -O3

SRC_DIR     = sources/
OBJ_DIR     = obj/

LIBFT_DIR   = libft
LIBFT       = $(LIBFT_DIR)/libft.a

MLX_DIR     = MLX42
MLX_LIB     = $(MLX_DIR)/build/libmlx42.a

MLX_FLAGS   = -ldl -lglfw -pthread -lm

SRC         = $(wildcard $(SRC_DIR)*.c)
OBJS        = $(SRC:$(SRC_DIR)/%.c=$(OBJ_DIR)/%.o)

# **************************************************************************** #
#                                   COLORS                                     #
# **************************************************************************** #

NC      = \033[0m
CL      = \033[36m
BW      = \033[1;37m
BG      = \033[1;32m
BY      = \033[1;33m

# **************************************************************************** #
#                                   RULES                                      #
# **************************************************************************** #

all: $(LIBFT) $(MLX_LIB) $(NAME)

# ---------------- LIBFT ---------------- #

$(LIBFT):
	@$(MAKE) -C $(LIBFT_DIR)

# ---------------- MLX42 ---------------- #

$(MLX_LIB):
	@cmake -S $(MLX_DIR) -B $(MLX_DIR)/build
	@cmake --build $(MLX_DIR)/build -j4

# **************************************************************************** #
#                               COMPILAR PROYECTO                              #
# **************************************************************************** #

$(NAME): $(OBJS) $(LIBFT) $(MLX_LIB)
	@$(CC) $(CFLAGS) $(OBJS) $(LIBFT) $(MLX_LIB) $(MLX_FLAGS) -o $(NAME)
	@printf "%b" "$(CL) -> $(BW)[$(NAME)]:\t$(BG)CompilaciÃ³n exitosa âœ…$(NC)\n"
	@echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€$(BY)"
	@echo " â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’ â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘ â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘  "
	@echo "â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’     â–‘â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’â–‘ "
	@echo "â–‘â–’â–“â–ˆâ–“â–’â–‘       â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’     â–‘â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’â–‘ "
	@echo "â–‘â–’â–“â–ˆâ–“â–’â–‘       â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’ â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’â–‘ "
	@echo "â–‘â–’â–“â–ˆâ–“â–’â–‘       â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’     â–‘â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’â–‘ "
	@echo "â–‘â–’â–“â–ˆâ–“â–’â–‘â–‘â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’     â–‘â–’â–“â–ˆâ–“â–’ â–’â–“â–ˆâ–“â–’  â–’â–“â–ˆâ–“â–’â–‘ "
	@echo " â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘ â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘ â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’ â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘ â–’â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘  "                                                                                                                   
	@echo "                by aamaya-g and vlorenzo ðŸ’ª"
	@echo "$(NC)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"

# **************************************************************************** #
#                               COMPILAR OBJETOS                               #
# **************************************************************************** #

$(OBJ_DIR)/%.o: $(SRC_DIR)%.c
	@mkdir -p $(OBJ_DIR)
	@printf "%b" "$(CL) -> $(BW)[$(NAME)]:\t$(NC)$<\r"
	@$(CC) $(CFLAGS) -c $< -o $@

# **************************************************************************** #
#                                   LIMPIEZA                                   #
# **************************************************************************** #

clean:
	@rm -rf $(OBJ_DIR)
	@$(MAKE) -C $(LIBFT_DIR) clean
	@printf "%b" "$(CL) -> $(BW)[$(NAME)]:\t$(BG)Objetos limpiados âŽ$(NC)\n"

fclean: clean
	@rm -rf $(NAME)
	@rm -rf $(MLX_DIR)/build
	@$(MAKE) -C $(LIBFT_DIR) fclean
	@printf "%b" "$(CL) -> $(BW)[$(NAME)]:\t$(BG)Proyecto limpiado ðŸ§¹$(NC)\n"

re: fclean all

.PHONY: all clean fclean re
.DEFAULT_GOAL := all